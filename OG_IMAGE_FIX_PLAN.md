# Open Graph Image Fix Plan

## Problem
Homepage, legal pages, and category pages are missing `og:image` tags, causing Open Graph validation to fail.

## Root Cause
These pages call `pageMeta()` without the `ogImageUrl` parameter. When `ogImageUrl` is undefined, `pageMeta()` doesn't generate `og:image` tags.

## Current Status
- ✅ Merchant pages: Have `og:image` (uses merchant logo or fallback to favicon)
- ❌ Homepage: Missing `og:image`
- ❌ Legal pages: Missing `og:image`
- ❌ Category pages: Missing `og:image`

## Fix Plan

### 1. Create Default OG Image Helper
Create a utility function to get default OG image URL:
- Location: `src/lib/og-image.ts` (or add to existing file)
- Function: `getDefaultOgImage(siteUrl: string): string`
- Returns: `${siteUrl}/favicon.svg` or a dedicated OG image

### 2. Update Homepage (`app/page.tsx`)
- Fetch hero background image from homepage data
- Use hero image if available, otherwise use default OG image
- Pass `ogImageUrl` and `ogImageAlt` to `pageMeta()`

### 3. Update Legal Pages (`app/[slug]/page.tsx`)
- Use default OG image (site logo/favicon)
- Pass `ogImageUrl` and `ogImageAlt` to `pageMeta()`

### 4. Update Category Pages (`app/category/[categorySlug]/page.tsx`)
- Check if category has an image field in CMS
- Use category image if available, otherwise use default OG image
- Pass `ogImageUrl` and `ogImageAlt` to `pageMeta()`

## Implementation Details

### Default OG Image
- Use `/favicon.svg` as fallback (already used in merchant pages)
- Or create a dedicated `/og-image.png` (1200x630px recommended)

### Image URLs
- Must be absolute URLs (not relative paths)
- Use `process.env.NEXT_PUBLIC_SITE_URL` or `getDomainConfigServer().domain`
- Format: `https://dealy.tw/favicon.svg`

### Alt Text
- Homepage: "Dealy TW 台灣最新優惠平台"
- Legal pages: Use page title or "Dealy TW"
- Category pages: Use category name or "Dealy TW"

## Files to Modify
1. `app/page.tsx` - Add `ogImageUrl` to `pageMeta()` call
2. `app/[slug]/page.tsx` - Add `ogImageUrl` to `pageMeta()` call
3. `app/category/[categorySlug]/page.tsx` - Add `ogImageUrl` to `pageMeta()` call
4. (Optional) `src/lib/og-image.ts` - Create helper function

## Testing
After implementation, verify:
1. Homepage has `og:image` tag
2. Legal pages have `og:image` tag
3. Category pages have `og:image` tag
4. All images are absolute URLs
5. Images are accessible (not 404)

## Expected Result
All pages will have complete Open Graph tags:
- `og:type` ✅
- `og:locale` ✅
- `og:site_name` ✅
- `og:url` ✅
- `og:description` ✅
- `og:title` ✅
- `og:image` ✅ (NEW)
- `og:image:secure_url` ✅ (auto-generated by Next.js)
- `og:image:alt` ✅ (NEW)

